<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Surprise for You</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&family=Great+Vibes&family=Quicksand:wght@500;700&family=Montserrat:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --pink: #ffafcc;
            --text-color: #5e548e;
            --wrong-red: #ffccd5; 
            --right-green: #b9fbc0;
        }

        * { box-sizing: border-box; }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(120deg, #ffafcc, #bde0fe, #ffc8dd, #b9fbc0, #fcf6bd);
            background-size: 400% 400%;
            animation: rainbowBG 15s ease infinite;
            display: flex; justify-content: center; align-items: center;
        }

        @keyframes rainbowBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        #lineCanvas { position: fixed; top: 0; left: 0; z-index: 1; width: 100%; height: 100%; }
        #musicSymbolsCanvas { position: fixed; top: 0; left: 0; z-index: 2; width: 100%; height: 100%; pointer-events: none; opacity: 0; transition: opacity 0.5s; }

        .container {
            background: linear-gradient(-45deg, #ffffff, #fff0f3, #f0f7ff, #ffffff);
            background-size: 300% 300%;
            animation: moveGradient 8s ease infinite;
            padding: 2.5rem 2rem;
            border-radius: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            position: relative;
            z-index: 10;
            backdrop-filter: blur(15px);
            border: 4px solid white; 
            box-shadow: 0 0 15px 5px rgba(255, 255, 255, 0.6), 0 0 20px 2px #ffafcc, 0 0 25px 5px #bde0fe;
        }

        @keyframes moveGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1 { font-family: 'Great Vibes', cursive; color: var(--text-color); margin: 0 0 15px 0; font-size: 2.5rem; }
        h2 { font-family: 'Dancing Script', cursive; color: #ff4d6d; font-size: 2rem; margin-bottom: 10px; }
        p { font-weight: 700; color: var(--text-color); font-size: 1.1rem; margin-bottom: 20px; }

        .page { display: none; }
        .active { display: block; animation: slideIn 0.6s cubic-bezier(0.23, 1, 0.32, 1); }

        @keyframes slideIn { from { transform: translateX(50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .options-grid { display: flex; flex-direction: column; gap: 12px; margin-top: 20px; position: relative; min-height: 280px; }

        button {
            width: 100%; padding: 14px; border: 2px solid #ffccd5;
            background: rgba(255, 255, 255, 0.9); border-radius: 20px;
            cursor: pointer; transition: 0.3s; color: var(--text-color);
            font-family: 'Quicksand', sans-serif; font-weight: 700;
            position: relative; overflow: hidden;
        }
        
        button:hover { 
            background: linear-gradient(45deg, #ffafcc, #bde0fe); 
            color: white; border-color: white; transform: scale(1.03); 
        }

        input[type="password"] {
            width: 100%; padding: 12px; border-radius: 15px; border: 2px solid #ffccd5;
            margin-bottom: 15px; text-align: center; font-family: 'Quicksand', sans-serif; outline: none;
        }

        .shake { animation: shake 0.4s ease-in-out; background-color: var(--wrong-red) !important; color: #b91c1c !important; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }

        .particle { position: absolute; border-radius: 50%; pointer-events: none; z-index: 999; }
        .cracker { position: absolute; width: 4px; height: 18px; border-radius: 2px; pointer-events: none; z-index: 999; }

        .valentine-title { font-family: 'Dancing Script', cursive; font-size: 3rem; font-weight: 700; color: #ff4d6d; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); animation: floatText 3s ease-in-out infinite; }
        .gift-container { display: flex; justify-content: center; gap: 20px; margin: 30px 0; }
        .gift-item { font-size: 60px; cursor: pointer; transition: 0.3s; animation: wobble 2s infinite; }
        @keyframes wobble { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(5deg); } 75% { transform: rotate(-5deg); } }
        .letter-view, .password-view, .music-view { display: none; text-align: left; }
        .letter-paper { background: #fff; padding: 20px; border-radius: 15px; font-family: 'Dancing Script', cursive; font-size: 1.4rem; color: #444; margin-bottom: 20px; min-height: 150px; border: 1px solid #eee; }
        .music-text { font-family: 'Montserrat', sans-serif; font-size: 1.2rem; color: #8338ec; line-height: 1.6; font-weight: 600; text-align: center; background: linear-gradient(45deg, #ff4d6d, #8338ec); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .back-icon { font-size: 0.8rem; cursor: pointer; display: inline-block; margin-top: 15px; background: #ffc8dd; padding: 8px 20px; border-radius: 20px; color: white; font-weight: bold; transition: 0.3s; }
        .center-btn { text-align: center; width: 100%; }
        .reveal-pass { opacity: 0; animation: slowShow 2s forwards; }
        @keyframes slowShow { to { opacity: 1; } }
    </style>
</head>
<body>

<canvas id="lineCanvas"></canvas>
<canvas id="musicSymbolsCanvas"></canvas>

<div class="container">
    <audio id="bgMusic" loop><source src="music.mp3.mp3" type="audio/mpeg"></audio>

    <div id="instruction-page" class="page active">
        <h1>Hyy Archana Madhu! üå∏</h1>
        <p>Follow the instructions:</p>
        <div style="text-align: left; margin: 20px 0; color: #777; font-size: 0.9rem;">
            <div>‚ú® 1. 1 Wrong answers = 2 kolathillatha Photos.</div>
            <div>‚ú® 2. Correct all the answers (20/20).</div>
            <div>‚ú® 3. Unlock your Passcode for your surprise</div>
        </div>
        <button onclick="startQuiz()">Babbee Are you Ready! ‚ú®</button>
    </div>

    <div id="quiz-area"></div>

    <div id="result-page" class="page">
        <h2>Results!</h2>
        <p id="result-text"></p>
        <button id="gift-btn" style="display:none;"></button>
    </div>

    <div id="penalty-page" class="page">
        <h2>Hold on Babbyy! üõë</h2>
        <p id="penalty-stats"></p>
        <p style="font-size: 0.8rem; color: #ff4d6d;">(Grand Total: All attempts included!)</p>
        <p>Do you accept this condition to proceed?</p>
        <button onclick="goToLockPage()">I Accept ‚ù§Ô∏è</button>
    </div>

    <div id="lock-page" class="page">
        <h2>Security Checkpoint üîí</h2>
        <p>Promise your bf that you will accept the penalty then only he gives you the pass code</p>
        <input type="password" id="masterPass" placeholder="Enter Password Here">
        <button onclick="checkMasterPass()">Unlock My Surprise ‚ú®</button>
        <p id="pass-error" style="color:red; font-size: 0.8rem; display:none; margin-top:10px;">Oops! Wrong Password Babbyy.</p>
    </div>

    <div id="gift-page" class="page">
        <h1 class="valentine-title">Happy Valentine's Day!</h1>
        <div id="gift-selection">
            <p>You unlocked three surprises, Babbyyy!</p>
            <div class="gift-container">
                <div class="gift-item" onclick="openView('letter-view')">üíå</div>
                <div class="gift-item" onclick="openView('music-view', true)">üéµ</div>
                <div class="gift-item" onclick="openView('password-view')">üéÅ</div>
            </div>
        </div>
        <div id="music-view" class="music-view">
            <div style="text-align: center; margin-top: 20px;">
                <p class="music-text">Every notes reminds me of you. <br> You are my Fav Person And this song is for Youu, Archaneeee. ‚ú®</p>
                <div class="center-btn"><div class="back-icon" onclick="backToGifts()">üå∏ Back</div></div>
            </div>
        </div>
        <div id="letter-view" class="letter-view">
            <div class="letter-paper" id="typed-letter"></div>
            <div class="center-btn"><div class="back-icon" onclick="backToGifts()">üå∏ Back</div></div>
        </div>
        <div id="password-view" class="password-view">
            <div style="text-align: center; margin-top: 20px;">
                <p>Secret Gift Password is:</p>
                <h2 class="reveal-pass" style="color: #ff4d6d; background: white; padding: 10px; border-radius: 10px; border: 2px dashed #ffafcc; margin-bottom: 25px;">Archanamadhu@7736</h2>
                <div class="center-btn"><div class="back-icon" onclick="backToGifts()">üå∏ Back</div></div>
            </div>
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('lineCanvas');
    const ctx = canvas.getContext('2d');
    const musicCanvas = document.getElementById('musicSymbolsCanvas');
    const mctx = musicCanvas.getContext('2d');

    let score = 0; 
    let currentIdx = 0;
    let time = 0;
    let totalWrongCumulative = 0; 

    const colors = ['#ffafcc', '#bde0fe', '#ffc8dd', '#fff', '#ff0054', '#8338ec', '#00f2ff', '#ffea00', '#b9fbc0', '#ff70a6', '#70d6ff', '#fb6f92'];
    const music = document.getElementById('bgMusic');

    const rawQuestions = [
        {q: "What am I to you?", a: ["All of these", "My comfort", "Special person", "Most fav person ever"], c: 0},
        {q: "Which of our dates will always be your favourite?", a: ["Tvm Cafee", "kadhal cafe", "Coocon", "Ayushus"], c: 0},
        {q: "Which outfits did I like you wearing the most?", a: ["All of these (bzc its you)", "Casual Outfits", "Traditional Outfits", "The Hot Outfits"], c: 0},
        {q: "Which day do you think I still remember clearly?", a: ["Tvm Days", "Kadhal Cafe", "Coocon", "Ayushus"], c: 0},
        {q: "When I looked at you first day, what did I feel?", a: ["Fully Nervous", "Calm", "Shy", "Happyy"], c: 0},
        {q: "What is my favorite Food?", a: ["Youhh", "Alfamm", "Mandhi", "Momos and orange Juice"], c: 0},
        {q: "Who is more annoying?", a: ["Definitely You", "Me", "Both of us", "Neither"], c: 0},
        {q: "What is my favorite thing about you?", a: ["Everything!", "Your Eyes", "Your Smile", "Effortless Movement"], c: 0},
        {q: "Which is my fav thing you says?", a: ["Entha Bibinneee", "Bibinee", "Babbyyy", "Poddaaa"], c: 0},
        {q: "Do you love me?", a: ["YESSS!", "No", "Maybe", "I'll think about it"], c: 0},
        {q: "What is the one thing I can't live without?", a: ["Your presence", "My Phone", "Football", "Sleep"], c: 0},
        {q: "Who is you fav njn ahno atho?", a: ["Youh babbyy", "Shrishitha", "Sandra", "Fidha"], c: 0},
        {q: "What is my favorite nickname for you?", a: ["Madhute Mole", "Product", "Babbyy", "Object"], c: 0},
        {q: "Which is your fav thing i done for youhh?", a: ["All the things I done", "Hand placements", "Effortless Movement", "Squeezing"], c: 0},
        {q: "Which is my fav colour, While we are in Trivandram?", a: ["Orange", "Black", "Yellow", "Blue"], c: 0},
        {q: "Which is my fav Outfits that I will not Forget in my entire life?", a: ["Pink Kurthi", "Crop tops", "Saree", "Nightdress"], c: 0},
        {q: "Give me the permission for doing kollathillatharam everyday while you are with me?", a: ["Yes Babbyy You can do anything without my permission", "No babbyyy", "Why Should I", "May be"], c: 0},
        {q: "What do I want from you forever?", a: ["Kollathilatharam", "Gifts", "Treats", "Dates"], c: 0},
        {q: "Are you the best thing that ever happened to me?", a: ["Without a doubt, YES!", "Maybe", "Second best", "I'm not sure"], c: 0},
        {q: "Will you be my Valentine?", a: ["YES!", "No way"], c: 0, special: true}
    ];

    let activeQuestions = [];

    function resize() { canvas.width = musicCanvas.width = window.innerWidth; canvas.height = musicCanvas.height = window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    // Background Animation
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height); mctx.clearRect(0, 0, musicCanvas.width, musicCanvas.height);
        time += 1; requestAnimationFrame(animate);
    }
    animate();

    function startQuiz() {
        prepareQuestions();
        document.getElementById('instruction-page').classList.remove('active');
        showQuestion();
    }

    function prepareQuestions() {
        // Shuffle the order of the questions
        activeQuestions = [...rawQuestions].sort(() => Math.random() - 0.5);
        currentIdx = 0;
        score = 0;
    }

    function showQuestion() {
        const quizArea = document.getElementById('quiz-area');
        quizArea.innerHTML = "";
        const data = activeQuestions[currentIdx];
        
        const page = document.createElement('div');
        page.className = "page active";
        page.innerHTML = `<h2>Question ${currentIdx + 1}</h2><p>${data.q}</p>`;
        
        const grid = document.createElement('div');
        grid.className = "options-grid";
        if(data.special) grid.id = "q20-grid";

        // Shuffle options for this specific question
        let options = data.a.map((text, i) => ({text, correct: i === 0}));
        options.sort(() => Math.random() - 0.5);

        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.innerText = opt.text;
            if(data.special && !opt.correct) {
                btn.id = "noButton";
                btn.onmouseover = moveNoButton;
                btn.onclick = moveNoButton;
            } else if (data.special && opt.correct) {
                btn.onclick = () => finalYes(btn);
            } else {
                btn.onclick = () => handleAnswer(btn, opt.correct);
            }
            grid.appendChild(btn);
        });

        page.appendChild(grid);
        quizArea.appendChild(page);
    }

    function handleAnswer(btn, isCorrect) {
        if(isCorrect) {
            score++; btn.style.backgroundColor = "#b9fbc0"; createSparkles(35);
        } else {
            btn.classList.add('shake'); totalWrongCumulative++;
        }
        setTimeout(() => {
            currentIdx++;
            if(currentIdx < activeQuestions.length) showQuestion();
            else showResult();
        }, 600);
    }

    function finalYes(btn) {
        score++; btn.style.backgroundColor = "#b9fbc0";
        const effectInterval = setInterval(() => { createMegaSpark(30); createCrackers(20); }, 100);
        setTimeout(() => {
            clearInterval(effectInterval);
            document.getElementById('quiz-area').innerHTML = "";
            document.getElementById('result-page').classList.add('active');
            showResult();
        }, 3000); 
    }

    function showResult() {
        const text = document.getElementById('result-text');
        const giftBtn = document.getElementById('gift-btn');
        if (score === 20) {
            text.innerText = "Perfect Score 20/20! Archana, you're amazing! ‚ù§Ô∏è";
            giftBtn.style.display = 'block'; giftBtn.innerText = "See the Penalty & Surprise"; 
            giftBtn.onclick = () => {
                document.getElementById('result-page').classList.remove('active');
                document.getElementById('penalty-page').classList.add('active');
                document.getElementById('penalty-stats').innerHTML = `Across all attempts, you clicked <b>${totalWrongCumulative}</b> wrong answers.<br>That means you owe Bibin <b>${totalWrongCumulative * 2}</b> photos!`;
            };
        } else {
            text.innerText = `Babbyy, you need 20/20! You only got ${score}/20 this time. Your current cumulative mistakes: ${totalWrongCumulative}`;
            giftBtn.style.display = 'block'; giftBtn.innerText = "Restart (Questions & Options will Shuffle!) üîÑ"; 
            giftBtn.onclick = () => {
                document.getElementById('result-page').classList.remove('active');
                startQuiz();
            };
        }
    }

    function moveNoButton() {
        const btn = document.getElementById('noButton');
        const grid = document.getElementById('q20-grid');
        btn.style.position = "absolute";
        btn.style.left = (Math.random() * (grid.clientWidth - 80)) + "px"; 
        btn.style.top = (Math.random() * (grid.clientHeight - 40)) + "px";
    }

    function goToLockPage() { document.getElementById('penalty-page').classList.remove('active'); document.getElementById('lock-page').classList.add('active'); }
    function checkMasterPass() { if(document.getElementById('masterPass').value === "Bibin@2005") { document.getElementById('lock-page').classList.remove('active'); document.getElementById('gift-page').classList.add('active'); } else { document.getElementById('pass-error').style.display = "block"; } }

    function createSparkles(count) { for (let i = 0; i < count; i++) { const p = document.createElement('div'); p.className = 'particle'; p.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)]; p.style.width = '10px'; p.style.height = '10px'; p.style.left = '50%'; p.style.top = '50%'; document.body.appendChild(p); const dX = (Math.random() - 0.5) * 700, dY = (Math.random() - 0.5) * 700; p.animate([{ opacity: 1, transform: 'scale(1)' }, { opacity: 0, transform: `translate(${dX}px, ${dY}px) scale(0)` }], 1000).onfinish = () => p.remove(); } }
    function createMegaSpark(count) { for (let i = 0; i < count; i++) { const p = document.createElement('div'); p.className = 'particle'; p.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)]; p.style.width = '15px'; p.style.height = '15px'; p.style.left = Math.random() * 100 + '%'; p.style.top = Math.random() * 100 + '%'; document.body.appendChild(p); const dX = (Math.random() - 0.5) * 1500, dY = (Math.random() - 0.5) * 1500; p.animate([{ opacity: 1, transform: 'scale(1.5)' }, { opacity: 0, transform: `translate(${dX}px, ${dY}px) scale(0)` }], 2000).onfinish = () => p.remove(); } }
    function createCrackers(count) { for (let i = 0; i < count; i++) { const c = document.createElement('div'); c.className = 'cracker'; c.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)]; c.style.left = Math.random() * 100 + '%'; c.style.top = Math.random() * 100 + '%'; document.body.appendChild(c); const angle = Math.random() * Math.PI * 2; const dist = Math.random() * 1000 + 300; const dX = Math.cos(angle) * dist; const dY = Math.sin(angle) * dist; c.animate([{ transform: `rotate(${angle}rad) translate(0,0) scaleY(1.5)`, opacity: 1 }, { transform: `rotate(${angle}rad) translate(${dX}px, ${dY}px) scaleY(0)`, opacity: 0 }], { duration: 900, easing: 'ease-out' }).onfinish = () => c.remove(); } }
    function openView(id, m) { document.getElementById('gift-selection').style.display = 'none'; document.getElementById(id).style.display = 'block'; if(id === 'letter-view') typeL(); if(m) { music.play(); musicCanvas.style.opacity = "1"; } }
    function backToGifts() { music.pause(); music.currentTime = 0; musicCanvas.style.opacity = "0"; document.getElementById('letter-view').style.display = 'none'; document.getElementById('password-view').style.display = 'none'; document.getElementById('music-view').style.display = 'none'; document.getElementById('gift-selection').style.display = 'block'; }
    function typeL() { const t = "My Dearest Archana,\n\nI am so lucky to have you. You make everything better. Happy Valentine's Day! \n\nForever yours,\nBibin ‚ù§Ô∏è"; const el = document.getElementById('typed-letter'); el.innerHTML = ""; let i = 0; const int = setInterval(() => { if(i < t.length) { el.innerHTML += t[i] === '\n' ? '<br>' : t[i]; i++; } else clearInterval(int); }, 50); }
</script>
</body>
</html>
